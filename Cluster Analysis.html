<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>cluster-analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Cluster Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Cluster Analysis_files/libs/quarto-html/quarto.js"></script>
<script src="Cluster Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Cluster Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Cluster Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Cluster Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Cluster Analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Cluster Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Cluster Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Cluster Analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.14.0.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="unsupervised-learning---cluster-analysis" class="level1">
<h1>Unsupervised Learning - Cluster Analysis</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>So far, we have been learning and implementing <strong>supervised</strong> machine learning methods. This requires having <em>labeled</em> data, meaning data that is already classified or tagged with the correct answer. For example, in classification methods, our training data already has labels. In <strong>unsupervised</strong> machine learning, our data is unlabeled. This means that for unsupervised learning, our data requires no upfront human intervention (a.k.a labeling our data before our analysis).</p>
</section>
<section id="cluster-analysis" class="level2">
<h2 class="anchored" data-anchor-id="cluster-analysis">Cluster Analysis</h2>
<p>The unsupervised learning method we will focus on today is <strong>clustering</strong>. This method measures similarity within unstructured data and groups similar points together into clusters. Some practical applications of clustering are:</p>
<ul>
<li>Recommendation Engines</li>
<li>Customer Segmentation</li>
<li>Social Network Analysis</li>
</ul>
</section>
<section id="types-of-clustering" class="level2">
<h2 class="anchored" data-anchor-id="types-of-clustering">Types of Clustering</h2>
<p>There are 4 main types of clustering algorithms:</p>
<ol type="1">
<li><p>Centroid-based clustering</p></li>
<li><p>Density-based clustering</p></li>
<li><p>Distribution-based clustering</p></li>
<li><p>Hierarchial clustering</p></li>
</ol>
<p>Choosing the right clustering algorithm is really dependent on the distribution and type of data you are working with. For the purposes of this presentation, we will be focusing on <strong>centroid-based clustering</strong>.</p>
</section>
<section id="centroid-based-clustering" class="level2">
<h2 class="anchored" data-anchor-id="centroid-based-clustering">Centroid-Based Clustering</h2>
<section id="the-math" class="level3">
<h3 class="anchored" data-anchor-id="the-math">The Math</h3>
<p>In order to determine similarity between points, we measure the Euclidean Distance between points, specifically between a datapoint and a “centroid”:</p>
<p><span class="math display">\[\sum^{k}_{j=1}\sum^{n}_{i=1}||x_i^{(j)}-c_j||^2\]</span></p>
<p><span class="math inline">\(k\)</span> number of these centroids are chosen randomly in our dataset. We then essentially just calculate the sum of the distance from all points to the centroids.</p>
<p><strong>How do we choose the amount of centroids and subsequent clusters for our data?</strong></p>
<p>We can use the <strong>Elbow Method</strong>. This involves iterating through a range of values for <span class="math inline">\(k\)</span> to determine our optimal number of clusters by looking at <em>cost</em>, which is our summed Euclidean Distance from point to cluster. This is also referred to as Within-Cluster Sum of Squares (WCSS). We tend to pick the number of clusters at which our WCSS remains constant, or parallel to the x-axis.</p>
</section>
</section>
<section id="the-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="the-algorithm">The Algorithm</h2>
<p>To run our cluster analysis, we can use Scikit-Learn’s <strong>K-means</strong> algorithm. To process the data, the K-means algorithm starts with a first group of our randomly selected centroids, which are used as the beginning points for every cluster, and then performs the iterative calculations to optimize the positions of the centroids.</p>
<p>It halts creating and optimizing clusters when either:</p>
<p>The centroids have stabilized — there is no change in their values because the clustering has been successful.</p>
<p>The defined number of iterations has been achieved.</p>
</section>
<section id="centroid-based-clustering-implementation" class="level2">
<h2 class="anchored" data-anchor-id="centroid-based-clustering-implementation">Centroid-Based Clustering Implementation</h2>
<p>Let’s use Kaggle’s Mall Customer Segmentation dataset to implement some cluster analysis.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.path <span class="im">import</span> Path</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> PathPatch</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'Mall_Customers.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out the data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data.head(<span class="dv">5</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Encoding gender variable</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.get_dummies(data, columns <span class="op">=</span> [<span class="st">'Gender'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CustomerID</th>
      <th>Age</th>
      <th>Annual Income (k$)</th>
      <th>Spending Score (1-100)</th>
      <th>Gender_Female</th>
      <th>Gender_Male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>200.000000</td>
      <td>200.000000</td>
      <td>200.000000</td>
      <td>200.000000</td>
      <td>200.000000</td>
      <td>200.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>100.500000</td>
      <td>38.850000</td>
      <td>60.560000</td>
      <td>50.200000</td>
      <td>0.560000</td>
      <td>0.440000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>57.879185</td>
      <td>13.969007</td>
      <td>26.264721</td>
      <td>25.823522</td>
      <td>0.497633</td>
      <td>0.497633</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>18.000000</td>
      <td>15.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>50.750000</td>
      <td>28.750000</td>
      <td>41.500000</td>
      <td>34.750000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>100.500000</td>
      <td>36.000000</td>
      <td>61.500000</td>
      <td>50.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>150.250000</td>
      <td>49.000000</td>
      <td>78.000000</td>
      <td>73.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>200.000000</td>
      <td>70.000000</td>
      <td>137.000000</td>
      <td>99.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We need to make sure that there are no null values for our model to work:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>CustomerID                0
Age                       0
Annual Income (k$)        0
Spending Score (1-100)    0
Gender_Female             0
Gender_Male               0
dtype: int64</code></pre>
</div>
</div>
<p>Let’s start with a basic example - suppose we want to extract a business insight involving only the variables <strong>Annual Income</strong> and <strong>Spending Score</strong>.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select our features</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> data[[<span class="st">'Annual Income (k$)'</span>, <span class="st">'Spending Score (1-100)'</span>]]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>wcss <span class="op">=</span> []</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the Elbow Method to find the number of clusters with the lowest cost</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cluster <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">11</span>):</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    kmeans <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> cluster, init <span class="op">=</span> <span class="st">'k-means++'</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    kmeans.fit(x)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    wcss.append(kmeans.inertia_)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot out the elbow curve (now you see where it gets its name from)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">11</span>), wcss, <span class="st">'o--'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Elbow Method'</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'No of Clusters'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'WCSS'</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Cluster%20Analysis_files/figure-html/cell-6-output-1.png" width="618" height="442"></p>
</div>
</div>
<p>Based on our elbow curve, our optimal number of clusters is 5. This is because there is not enough dropoff between 5 clusters and 6-10 clusters to warrant the extra computational expense and the more clusters we have, the less interpretable our results may become (not enough difference between clusters/redundancy).</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement our algorithm</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">5</span>, init <span class="op">=</span> <span class="st">'random'</span>, n_init <span class="op">=</span> <span class="dv">10</span>, max_iter <span class="op">=</span> <span class="dv">300</span>, tol <span class="op">=</span> <span class="fl">1e-4</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit our model</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> model.fit_predict(x)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at our results</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>array([4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0,
       4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 0, 4, 1,
       4, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 3, 1, 3, 2, 3, 2, 3,
       1, 3, 2, 3, 2, 3, 2, 3, 2, 3, 1, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3,
       2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3,
       2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3,
       2, 3])</code></pre>
</div>
</div>
<p>Our model output is an array telling us each cluster that our datapoints fall into. We can visualize this now to better understand our clusters:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'First_cluster'</span>] <span class="op">=</span> model.labels_</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>CustomerID</th>
      <th>Age</th>
      <th>Annual Income (k$)</th>
      <th>Spending Score (1-100)</th>
      <th>Gender_Female</th>
      <th>Gender_Male</th>
      <th>First_cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>19</td>
      <td>15</td>
      <td>39</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>21</td>
      <td>15</td>
      <td>81</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>20</td>
      <td>16</td>
      <td>6</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>23</td>
      <td>16</td>
      <td>77</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>31</td>
      <td>17</td>
      <td>40</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>196</td>
      <td>35</td>
      <td>120</td>
      <td>79</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>196</th>
      <td>197</td>
      <td>45</td>
      <td>126</td>
      <td>28</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>197</th>
      <td>198</td>
      <td>32</td>
      <td>126</td>
      <td>74</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>198</th>
      <td>199</td>
      <td>32</td>
      <td>137</td>
      <td>18</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>199</th>
      <td>200</td>
      <td>30</td>
      <td>137</td>
      <td>83</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 7 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'red'</span>, <span class="st">'orange'</span>, <span class="st">'magenta'</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the clusters and their centroids</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(colors)):</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    plt.scatter(data[<span class="st">'Annual Income (k$)'</span>][data[<span class="st">'First_cluster'</span>] <span class="op">==</span> i],</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                data[<span class="st">'Spending Score (1-100)'</span>][data[<span class="st">'First_cluster'</span>] <span class="op">==</span> i],</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>colors[i], label<span class="op">=</span><span class="ss">f'Cluster </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plt.scatter(model.cluster_centers_[:, <span class="dv">0</span>], model.cluster_centers_[:, <span class="dv">1</span>], c <span class="op">=</span> <span class="st">'black'</span>, label <span class="op">=</span> <span class="st">'Centroids'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Clusters'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Annual Income (k$)'</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Spending Score (1-100)'</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Cluster%20Analysis_files/figure-html/cell-9-output-1.png" width="594" height="442"></p>
</div>
</div>
</section>
<section id="interpreting-results" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-results">Interpreting Results</h2>
<p>An important part of data science is being able to interpret your results. For example, we see that members of cluster 0 have both high annual income and spending score. This means that we should send them repeated promotions and updates regarding the mall. Cluster 4 members have high spending score but low income; this means that we could send them discounts/sales that are going on within the mall.</p>
</section>
<section id="re-clustering-with-principal-component-analysis" class="level2">
<h2 class="anchored" data-anchor-id="re-clustering-with-principal-component-analysis">Re-clustering with Principal Component Analysis</h2>
<p>In our last example, we only used two features or ‘dimensions’ in our model (Average Income and Spending Score). Yet, most of the time we use more than just 2 dimensions. To be able to visualize our data in 2 dimensions, we can use <strong>Principal Component Analysis</strong> to reduce the dimensionality of our data. While it makes interpretation of our results more difficult, it allows us to cluster on as many features as we’d like.</p>
<p>We will revisit our mall data but use all possible features. In our previous clustering, our dimensions were similar in scale. But because we are using gender and age data, we will need to standardize our features:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="op">=</span> scaler.fit_transform(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we use PCA:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting all features except for Customer ID</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>pca.fit(scaled_data[:, <span class="dv">1</span>:])</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>), pca.explained_variance_ratio_.cumsum(), marker <span class="op">=</span> <span class="st">'o'</span>, linestyle <span class="op">=</span> <span class="st">'-'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Variance Explained by Components'</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'# of Components'</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Variance'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>Text(0, 0.5, 'Variance')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Cluster%20Analysis_files/figure-html/cell-11-output-2.png" width="589" height="442"></p>
</div>
</div>
<p>Typically, we keep 80% of our variance, so we want to use 3 components.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>pca_data <span class="op">=</span> pca.fit_transform(scaled_data)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>pca_wcss <span class="op">=</span> []</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the Elbow Method to find the number of clusters with the lowest cost</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cluster <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">11</span>):</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    kmeans <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> cluster, init <span class="op">=</span> <span class="st">'k-means++'</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    kmeans.fit(pca_data)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    pca_wcss.append(kmeans.inertia_)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot out the elbow curve (now you see where it gets its name from)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">11</span>), pca_wcss, <span class="st">'o--'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Elbow Method'</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'No of Clusters'</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'WCSS'</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Cluster%20Analysis_files/figure-html/cell-12-output-1.png" width="601" height="442"></p>
</div>
</div>
<p>Let’s use 4 clusters.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pca_model <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">4</span>, init <span class="op">=</span> <span class="st">'random'</span>, n_init <span class="op">=</span> <span class="dv">10</span>, max_iter <span class="op">=</span> <span class="dv">300</span>, tol <span class="op">=</span> <span class="fl">1e-4</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit our model</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pca_results <span class="op">=</span> pca_model.fit_predict(pca_data)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at our results</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>pca_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>array([3, 3, 0, 0, 0, 0, 0, 0, 3, 0, 3, 0, 0, 0, 3, 3, 0, 3, 3, 0, 3, 3,
       0, 3, 0, 3, 0, 3, 0, 0, 3, 0, 3, 3, 0, 0, 0, 0, 0, 0, 0, 3, 3, 0,
       0, 0, 0, 0, 0, 0, 0, 3, 0, 3, 0, 3, 0, 3, 0, 3, 3, 3, 0, 0, 3, 3,
       0, 0, 3, 0, 3, 0, 0, 0, 3, 3, 0, 3, 0, 0, 3, 3, 3, 0, 0, 3, 0, 0,
       0, 0, 0, 3, 3, 0, 0, 3, 0, 0, 3, 3, 0, 0, 3, 3, 3, 0, 0, 3, 3, 3,
       3, 0, 0, 3, 0, 0, 0, 0, 0, 0, 2, 0, 0, 2, 1, 1, 2, 2, 2, 2, 2, 2,
       1, 1, 2, 1, 1, 2, 2, 1, 1, 2, 1, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 1,
       1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2, 2, 2, 2, 1, 1,
       2, 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2,
       2, 2])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make an interactive 3D Plot to show our work</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'PCA_cluster'</span>] <span class="op">=</span> pca_model.labels_</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter_3d(x <span class="op">=</span> pca_data[:, <span class="dv">0</span>], y <span class="op">=</span> pca_data[:, <span class="dv">1</span>], z <span class="op">=</span> pca_data[:, <span class="dv">2</span>], color <span class="op">=</span> pca_model.labels_)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="b3e9e845-2e0f-4118-aa30-520e36205b81" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b3e9e845-2e0f-4118-aa30-520e36205b81")) {                    Plotly.newPlot(                        "b3e9e845-2e0f-4118-aa30-520e36205b81",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<br>z=%{z}<br>color=%{marker.color}<extra></extra>","legendgroup":"","marker":{"color":[3,3,0,0,0,0,0,0,3,0,3,0,0,0,3,3,0,3,3,0,3,3,0,3,0,3,0,3,0,0,3,0,3,3,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,3,0,3,0,3,0,3,0,3,3,3,0,0,3,3,0,0,3,0,3,0,0,0,3,3,0,3,0,0,3,3,3,0,0,3,0,0,0,0,0,3,3,0,0,3,0,0,3,3,0,0,3,3,3,0,0,3,3,3,3,0,0,3,0,0,0,0,0,0,2,0,0,2,1,1,2,2,2,2,2,2,1,1,2,1,1,2,2,1,1,2,1,1,2,2,2,1,1,2,2,2,1,1,1,1,2,1,2,1,1,1,2,1,2,1,2,1,1,2,2,2,2,2,1,1,2,2,2,2,1,1,2,1,1,2,1,2,1,1,1,1,2,1,1,1,1,2,2,2],"coloraxis":"coloraxis","symbol":"circle"},"mode":"markers","name":"","scene":"scene","showlegend":false,"x":[-0.4607833335215254,-1.4194594635674835,-2.028338375624609,-3.091951124431213,-2.0598719374156125,-3.0553207346685047,-1.8705718162287206,-3.080154817349175,0.0730217436477016,-2.9202630811405377,0.06565528844511033,-2.977677949934359,-1.685467922083431,-2.9153213163077405,-0.036617632460489415,-1.1787387190955316,-1.8297229372832782,-1.1018627107343466,0.08027035652110134,-2.820897982495231,0.0035654066670023484,-1.0049127132974343,-1.5212195261871033,-0.9341573588146587,-1.4338609610462334,-0.9009849617749105,-1.5328882886251818,-0.7703242721242576,-1.5179323661029238,-2.632837156851032,0.46822211329966923,-2.552155795539131,0.5085496028452995,-0.8256615849077357,-1.2697357769862798,-2.4861042351034963,-1.2808384998871092,-2.368650206584656,-1.2693405700878098,-2.352189273370794,-1.1082052055288967,-0.6201681927614944,0.5709105692795015,-1.9581205328681859,-1.111785373388631,-2.197737392554035,-1.7849727537371833,-1.870039828351563,-1.8310575415652857,-1.8111020195325886,-1.7024880044509423,-0.0737164486970717,-1.76939015931229,0.10541124198794759,-1.613951686538769,0.13092612315514995,-1.5893161808601335,0.2693525818461409,-1.664917606834282,0.24090544330360528,0.3040866879808269,0.04066087202829534,-1.3954980569334616,-1.4834592577074572,0.3616704423078271,0.09650815065952571,-1.461453924027672,-1.3092595094609627,0.12928163270705775,-1.4822877848493385,0.4590961554477449,-1.3437381143219735,-1.2708082012358972,-1.2883273834784343,0.5664427317779129,0.37010919480167326,-1.2508074043519248,0.4870385246724857,-1.3479750443987297,-1.1599191894161813,0.595093816829665,0.4860369740471437,0.7055700912628923,-1.147312592098056,-1.3231293122976933,0.6109444723546017,-1.06444388648818,-1.2227238939572602,-1.1476018917798643,-0.9985107930955741,-0.9060985018603682,0.6221578472654371,0.7833988931727051,-0.9533775362481945,-0.9952188882180507,0.6692908961152849,-0.9147298239950005,-1.0253999306369177,0.8847531710997127,0.715512718174034,-0.9454572024891915,-0.8220923476688126,0.9794961207767235,0.7816725317774614,0.9116136538717988,-0.9145083469977651,-0.6719880489388145,1.0241222094640945,1.1205171920702863,1.099771482108956,1.0882497419084534,-0.8962930087545833,-0.718549688744232,0.909187428382165,-0.8115104890286678,-0.8045842897075137,-0.5304093909950937,-0.6580373851356447,-0.5371820622971807,-0.5867573320048418,1.038332082634686,-0.568853156739071,-0.5773798342249469,1.4469405639870019,-0.3161957237668441,-0.24168373547068872,1.3396804012249788,1.5136250762384564,1.7406450248660477,1.5971314784574964,1.7014689058710801,1.620786672092555,-0.41612650104324606,-0.10589115687229428,1.646874971045121,-0.14317573703258557,0.05075368550240948,1.685190944392355,1.678909819928479,0.006701841486591269,0.20529371717950565,1.6855711926222428,-0.2514915770038464,0.00985300403972239,1.8185417757540292,1.7251626208231365,1.870078068394375,0.1158028228460783,0.14894206807601126,1.84079202278587,1.9717669208544657,1.8937323895628095,0.2472120957284582,0.2154206250773161,0.29692593478660495,0.12458282863172257,2.0548505976800864,0.20093413834488044,2.0568313240746967,0.2381974799234066,0.3481085872860092,0.23296898722823878,2.0568250441615126,0.2640034217605636,2.2431546373235287,0.4578577429375815,2.2608814741690293,0.40373848711503046,0.5031819963665294,2.295128778258847,2.3331619416508658,2.246026652434755,2.3411401100875113,2.24292116357843,0.717871613910343,0.5346912741352362,2.497803145603449,2.338156960600934,2.625299076175005,2.419865443927526,0.7990640773443046,0.7803019294047064,2.687560242328505,0.7946790266950411,0.8705883811739485,2.540887080479732,1.0563614243854038,2.698655812849527,1.0708076069282155,0.9987705176785956,1.0282817483780824,1.0562182744745479,3.0350447305341346,1.2233195552159806,1.5019546967661002,1.4110140545992742,1.5837322653451695,3.288857966439319,3.5264521578234533,3.482086977856317],"y":[-2.3073936485466513,-2.71140882385106,-0.183616375301424,-0.5064473228821456,-0.12839413584369985,-0.4713078233798589,-0.2299366373578832,-0.3926848259906583,-2.618035244265175,-0.47929956271927676,-2.591380782396246,-0.41830659969885425,-0.29178613896254907,-0.37500800349078656,-2.3321614393896795,-2.5403207152594156,-0.01907367050564784,-2.534543795313433,-2.313512990490353,-0.29747323449576873,-2.1415566471061442,-2.47115626276665,-0.08080845097920807,-2.483490282716822,-0.0477515054267656,-2.378259263310666,0.08685017078259948,-2.4708036554423227,0.1508592998263722,-0.07334848372401749,-2.245442614495931,-0.07061989602317499,-2.131559548369175,-2.128307367138408,0.14318765331037275,0.03190300569560514,0.2338249261054483,-0.02646989437179984,0.36792557505309054,0.11516205840135023,0.21702617544563227,-2.0315347189688624,-1.8268783627540148,0.18628423182786627,0.35691182158616047,0.13252498446108574,0.06922143706127956,0.21822266362795822,0.1959337022957699,0.18888640218928024,0.12923469643534455,-1.9241318331314998,0.29621511822436636,-2.0808140007891005,0.1464244170245574,-2.037348395493792,0.1854190952269414,-2.1499192723842087,0.40885102411660146,-1.9872749348226595,-2.0721000232583235,-1.699673064185266,0.16894851463744656,0.2915006510275065,-1.9748789840623096,-1.6183214790952232,0.3818150810866443,0.2026707466263319,-1.6033763424878344,0.4742241095830706,-1.9526870237602814,0.38169176193885634,0.3327867013428092,0.3615125417230405,-1.787155166657552,-1.5202548825600621,0.5475727798951517,-1.6248135500975946,0.7180824394566903,0.5073340396498887,-1.7162019349207303,-1.5594903509538605,-1.8040843018973363,0.5646329849532954,0.7920840034386513,-1.6295493563568195,0.6131016990103177,0.8495186606564091,0.8017343429554539,0.6509666880218075,0.5720712549891823,-1.3029667328681065,-1.4715193867703293,0.7667916171287961,0.8380150553663007,-1.266994068793235,0.7597706351399337,0.9206512942470351,-1.4323372294672385,-1.2015239822966062,0.9766392676421228,0.8177125160026965,-1.471900867931357,-1.1807929794474337,-1.3363575024015835,1.0310599879792717,0.7542462232964776,-1.3645699227535286,-1.4673711082198957,-1.4303071175592004,-1.403508866529017,1.1425952727107613,0.9924674551448291,-1.0514401812464589,1.1860760206851533,1.1923427924543142,0.8608260564462455,1.0180305904279352,0.9946007644663089,1.0518823379478905,-0.9783973301276109,1.1014446077334783,1.1816580781066042,-0.6412623413654256,1.378172250284368,1.6053899110058039,-1.0487841573217702,-0.5743455710461253,-1.091398162669115,-0.6061023718496712,-0.9961109092064306,-0.598544749906536,1.339220546747003,1.6785908249160908,-0.7514933900578483,1.775817712216266,1.2967797468701816,-0.4774036846465965,-0.683288867756215,1.7294854056723639,1.2587976350941856,-0.3544961910196892,1.474515044838459,1.8588034602296872,-0.6275853744919954,-0.2514923837735315,-0.7056507411436781,1.864920594733433,1.58430595553978,-0.2703897001111759,-0.6817365631839137,-0.2977983721998058,1.535585275852799,1.8882332979305532,1.5165147540446322,2.0220281276849628,-0.6428803468084013,1.9816192801608177,-0.6064530953237803,1.981152648263625,1.569996883253014,2.04982380246245,-0.40786241180498717,2.1130381295387104,-0.48803045414086166,2.1016377216620437,-0.41761076416667275,2.215227013083009,1.878621650581749,-0.04475100737219305,-0.3787688214213454,0.0354736384394763,-0.34426915928677215,0.044331056852386815,1.7809869640029181,2.3009351524139916,-0.4420650068486825,0.08492153537307816,-0.35657874198293826,0.18694925793429643,2.1372500307286124,2.4765839809307155,-0.1491770799032079,2.535303291939166,2.191659575627218,0.38587207876395074,2.0992741153358985,0.35907107782124614,2.2189279050253554,2.6009385066594146,2.3025147795223,2.5958098496071713,0.24011696253642092,2.796297694352021,2.492221932023852,2.9095127241298124,2.655184133266076,0.8272514642318751,0.7108322611639031,1.0620456439064292],"z":[0.17050579490833126,-2.085222147951179,1.54953152196159,-1.4100789794231887,1.144653355299002,-1.4346803366295284,2.1878720263185922,-1.8619789456434932,3.02707572136927,-0.9975851324248728,2.870699970499669,-1.479345222391104,2.9387567100183274,-1.3975121674304967,1.581984416572015,-2.0313319885524543,1.413179950880723,-1.7901572925958205,1.8044145200136732,-1.4811611732034562,0.9038068035856694,-1.7705444278311884,2.6402755947379424,-1.5165875721741886,2.7420951747105407,-1.8495239690115977,1.8836154553432798,-1.0508018579209313,1.685111707412936,-1.7574461840368885,2.7515383250225547,-1.4905005171765904,2.433162677913123,-2.61662704071198,2.4902335341605157,-1.7140366117206267,2.1016947072535124,-1.1234851957913081,1.5948559196921004,-1.6238295777510718,2.616812783879136,-2.3869352427987036,1.3530551019891217,-0.4839385143964062,2.09138142290748,-1.2093328028207253,0.48816600454944425,-0.30726590687040284,-0.09312078897622493,-0.007830525600369771,0.5082098587214287,-0.8872332233703791,-0.3327895717729177,0.23623558590663538,0.721863658326784,0.20085499693195993,0.6295876710604578,1.0215665609666496,-0.45006924107294005,0.3154854011849216,0.7951999207391424,-1.3979455220743766,1.2529651008621276,0.50572460269732,0.6059321306324512,-1.5582984642280437,0.2508741039241423,1.387645055770343,-1.5198056625054825,-0.1550273538143113,0.7936369724112085,0.619064735490018,0.9986149105745179,0.8165571822627198,0.49705510492137395,-1.1196973468634481,0.22245386797341732,-0.3597350178797437,-0.7115601740772273,0.674854142679291,0.297054434027836,-0.6337267375119823,0.9861982559021956,0.4862416798843743,-0.9373318158744293,0.026324249486420277,0.5010210710335036,-0.858021671714673,-0.4704051525038449,0.5843370710573237,1.129723292739498,-1.1769287506257147,-0.08406438586786702,0.2904134588112951,-0.11059419643018625,-1.2097744388813172,0.40936305029420944,-0.5391227480229452,0.08279195208419479,-1.3165825112956238,-0.4932189294858293,0.4550888819083913,0.4605032082596149,-1.2205733450329033,-0.24806650125969754,-0.6142457556822272,1.1307525742906308,0.21846353376680053,0.9027738820256579,0.6853069001591875,0.5370864868773819,-1.023989060261793,0.10606314807833724,-1.3167228434418146,-0.924971361392669,-0.9346986375051435,1.156963524798394,0.13430869081960517,0.6247847557406692,0.2188546334222192,-1.248978894303613,0.1319321026402146,-0.25380484316331486,-1.0120695184909987,0.062230779107302715,-0.5139726177363717,-0.03644400017437072,-1.0854712652826644,1.5890063575076594,-0.6603249065436682,1.1155192631706874,-0.6201711728349603,-0.31476942592197554,-0.3797839811169786,0.030968548540317005,-0.9117384122702812,1.5115239070850466,-0.8900737396249374,-0.15158049806030266,-0.24876788612694137,2.114455157887377,-1.4192866185562365,-0.36987724398927024,-0.77955270358292,0.03704095493135977,-1.7100663537529064,0.415154535934135,-0.4547486762365781,0.6523978506027572,-1.279034565742547,0.6772064002974602,-1.0134364995025071,1.1320520412755082,-0.2589774903314925,1.3622408539608755,-1.0755535505424323,0.8187227567532098,-0.664967941531413,0.6849740997379149,-0.5394349509853831,1.2503323275466667,-0.8475169881320335,-0.0876120764064741,-1.0287470986923932,0.7013197329284548,-0.36511296382056657,0.5012440464734316,-1.0178559053658636,0.5451017536131051,-0.7355619845389375,0.584471053035785,-1.222037890079207,0.48455971105048296,-1.3156614779657911,1.58796445078683,-0.9367811490784792,1.3019494111128793,-1.1244281207118105,1.3499997834416937,-1.33900992449661,0.40404264837491183,-0.8919693437437596,0.7345279824568773,-1.0808348090230946,0.38375478191525453,-1.7681994998844128,1.3250305184375157,-1.1182641359258585,0.9297729480244425,-0.7270326367455316,0.46749607486315753,-0.4919213569831952,0.27950969221738303,-0.837099659317218,1.1456591833331378,-0.6866207306855191,0.7246852744146002,-1.204968551903094,-0.11743800137821715,-1.5665038803941955],"type":"scatter3d"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"scene":{"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"xaxis":{"title":{"text":"x"}},"yaxis":{"title":{"text":"y"}},"zaxis":{"title":{"text":"z"}}},"coloraxis":{"colorbar":{"title":{"text":"color"}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b3e9e845-2e0f-4118-aa30-520e36205b81');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<p>Interpreting these clusters is a little more difficult. Here are a few different methods to try and find insights into your clusters:</p>
<ol type="1">
<li><p>Use ANOVA to compare features against clusters (e.g.&nbsp;Average Income ~ Cluster).</p></li>
<li><p>Build a <em>supervised</em> learning model (something like K-nearest neighbor) which takes a new data point and assigns it to one of the clusters based on its features. In this instance, we use unsupervised learning to label our data for subsequent supervised learning methods.</p></li>
</ol>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>While a lot of the methods and practices I covered today don’t have the strongest application to the dataset I used, I wanted to (1) use an easy to understand and easily interpretable dataset and (2) show off as many helpful tools when clustering on more complex datasets. Overall, cluster analysis and unsupervised learning are important skills to have if you would like to work with data science in the future.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>